---  
lajout: post  
title: JDBC  
tags: JDBC  
categories: JavaSE  
published: true  
---  

## 连接步骤

1. 注册驱动(Driver)
2. 建立连接(Connection)
3. 创建执行声明(Statement)
4. 执行语句
5. 处理结果(ResultSet)
6. 释放资源

### 注册驱动

```java
// 注册时加载一次，new类时静态类加载一次
DriverManager.registerDriver(new oracle.jdbc.OracleDriver());
// DriverManager初始化时会读取参数进行加载
System.setProperty("jdbc.driver", "oracle.jdbc.OracleDriver");
// Driver静态代码块加载 推荐使用
Class.forName("oracle.jdbc.OracleDriver");
```

### 创建连接

数据库连接是稀缺资源，用完后必须马上释放，Connection的使用原则是尽量晚创建，尽量早释放。

```java
String url = "jdbc:oracle:thin:@127.0.0.1:1521:dbname";
String username = "username";
String password = "password";
Connection connection = DriverManager.getConnection(url, username, password);
```

#### 连接字符串

* oracle
    - driverClass：oracle.jdbc.driver.OracleDriver
    - url：jdbc:oracle:thin:@127.0.0.1:1521:dbname
* mysql
    - driverClass：com.mysql.jdbc.Driver
        + 有的时候，mysql的驱动类也也会看到使用org.gjt.mm.mysql.Driver的情况，org.gjt.mm.mysql.Driver是早期的驱动名称，后来就改名为com.mysql.jdbc.Driver，现在一般都推荐使用 com.mysql.jdbc.Driver。在最新版本的mysql jdbc驱动中，为了保持对老版本的兼容，仍然保留了org.gjt.mm.mysql.Driver，但是实际上 org.gjt.mm.mysql.Driver中调用了com.mysql.jdbc.Driver，因此现在这两个驱动没有什么区别。
    - url：jdbc:mysql://localhost:3306/mydb
* DB2
    - driverClass：com.ibm.db2.jcc.DB2Driver
    - url：jdbc:db2://127.0.0.1:50000/dbname
* sybase
    - driverClass：com.sybase.jdbc.SybDriver
    - url：jdbc:sybase:Tds:localhost:5007/dbname
* PostgreSQL
    - driverClass：org.postgresql.Driver
    - url：jdbc:postgresql://localhost/dbname
* Sql Server 2000
    - driverClass：com.microsoft.jdbc.sqlserver.SQLServerDriver
    - url：jdbc:microsoft:sqlserver://localhost:1433;DatabaseName=dbname
* Sql Server 2005
    - driverClass：com.microsoft.sqlserver.jdbc.SQLServerDriver
		+ SQL Server2000和2005的驱动是有区别的，使用错误的时候，会出现下面这个错误。java.sql.SQLException: [Microsoft][SQLServer JDBC Driver][SQLServer]传入的表格格式数据流(TDS)远程过程调用(RPC)协议流不正确。参数 1 (""): 数据类型 0x38 未知。
    - url：jdbc:sqlserver://localhost:1433; DatabaseName=dbname

### 创建执行声明

```java
Statement statement = connection.createStatement();
```

### 执行语句

```java
String sql = "select * from user";
ResultSet resultSet = statement.executeQuery(sql);
```

### 处理结果

```java
while (resultSet.next()) {
    System.out.println(resultSet.getObject(0));
}
```

### 释放资源

```java
resultSet.close();
statement.close();
connection.close();
```

## 异常处理



------

*以上概念总结于传智播客JavaWeb课程*