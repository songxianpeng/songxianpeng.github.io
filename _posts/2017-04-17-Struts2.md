---  
lajout: post  
title: Struts2  
tags: Struts2  
categories: JavaEE  
published: true  
---  

## Struts2

Struts2是在Struts1和webwork基础之上发展的`全新`的框架

### 配置

**web.xml**

```xml
<!-- Struts2 filter -->
<filter>
    <filter-name>struts2</filter-name>
    <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>
    <init-param>
        <param-name>struts.i18n.encoding</param-name> 
        <param-value>utf-8</param-value>
    </init-param>
</filter>
```

**struts.xml**

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
        "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
        "http://struts.apache.org/dtds/struts-2.0.dtd">
<struts>
    <constant name="struts.devMode" value="true"/>
    <package name="basicStruts2" extends="struts-default">
        <action name="index">
            <result>/index.html</result>
        </action>
        <action name="hello" class="com.xpress.hello.action.HelloWorldAction" method="execute">
            <result name="success">/index.jsp</result>
        </action>
    </package>
</struts>
```

**action**

```java
public class HelloWorldAction extends ActionSupport {
    private static final long serialVersionUID = 1L;
    public String execute() throws Exception {
        return SUCCESS;
    }
}
```

#### struts.xml配置文件

##### include

```xml
<include file="struts-login.xml"/>
```

##### constant

常量配置，可配置default.properties内容，另可在web.xml中的filter init参数中配置，也可在struts.properties中配置

**常用常量**

```xml
<constant name="struts.devMode" value="true"/>
<constant name="struts.i18n.encoding" value="UTF-8"/>
```

##### package

包

* name 包名
* extends 继承关系
    - 默认`struts-default`
* namespace package访问路径

##### package>action

动作

* name action访问路径
* class action执行的class全路径
* method action执行的方法名称

##### package>action>result

返回结果

* name 同方法返回值
* type 结果处理方式（转发或重定向，默认转发）

### 源码分析

* org.apache.struts2.dispatcher.filter.StrutsPrepareAndExecuteFilter
    - init()方法加载配置文件包含自己创建的配置和struts自带的配置
        + init_DefaultProperties(); org/apache/struts2/default.properties
        + init_TraditionalXmlConfigurations(); DEFAULT_CONFIGURATION_PATHS:struts-default.xml,struts-plugin.xml,struts.xml
        + init_LegacyStrutsProperties(); stuts.properties, struts.custom.properties
        + init_CustomConfigurationProviders(); 用户自定义的配置加载器
        + init_FilterInitParameters(); filter的init参数配置
        + init_AliasStandardObjects(); 初始化标准类
    - doFilter()


------

*以上概念总结于传智播客JavaWeb课程*